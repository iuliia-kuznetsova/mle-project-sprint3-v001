Мониторинг

Данный дашборд в Grafana предназначен для мониторинга сервиса предсказаний Real Estate Price Prediction API.
Он обеспечивает наблюдаемость за производительностью, стабильностью и надежностью модели и инфраструктуры, используя метрики, собираемые Prometheus.
Дашборд позволяет отслеживать задержки предсказаний, объем запросов, количество ошибок и общее состояние работы системы в реальном времени.

Для мониторинга выбраны метрики нескольких слоев:

    - Метрики реального времени (Бизнес-слой):

        -- Количество запросов в процессе обработки / Number of Requests in Progress

        Показывает количество активных HTTP-запросов, которые обрабатываются в данный момент.
        Метрика выбрана для контроля перегрузок сервиса и выявления ситуаций, когда одновременно обрабатывается слишком много запросов.
        Используется stat value для отображения числа в реальном времени.
        PromQL: 
        inprogress_requests

        -- Медианное значение предсказания / Median Prediction

        Отображает медианное значение (50-й перцентиль) всех предсказаний модели.
        Метрика помогает выявить аномалии в предсказаниях модели.
        Используется  time-series для отслеживания изменений типичных предсказаний во времени.
        PromQL:
        histogram_quantile(0.5, main_app_predictions_bucket)

    - Метрики прикладного уровня (Прикладной слой):

        -- Общее количество предсказаний / Total Number of Predictions Made

        Показывает общее число предсказаний, выполненных моделью с момента запуска сервиса.
        Метрика выбрана для анализа общей активности и использования системы.
        Используется stat value для отображения числа в реальном времени.
        PromQL:
        sum(predictions_total)

        -- Средняя задержка предсказания / Average Prediction Latency

        Показывает среднее время (в секундах), необходимое модели для генерации одного предсказания.
        Эта метрика является ключевой для оценки производительности и стабильности модели.
        Используется gauge для отображения числа в реальном времени.
        PromQL:
        sum(rate(prediction_latency_seconds_sum[5m])) / sum(rate(prediction_latency_seconds_count[5m]))

        -- Прирост количества предсказаний за 1 минуту / Predictions Number Increase over 1 Minute

        Показывает сколько предсказаний было выполнено за последнюю минуту.
        Помогает оценить текущую активность пользователей и нагрузку на модель.
        Используется time-series для визуализации изменения во времени.
        PromQL:
        rate(predictions_total[1m])

        -- Распределение задержек предсказаний / Prediction Latency Distribution

        Показывает, как распределяются запросы по времени выполнения предсказания.
        Метрика позволяет выявить редкие, но очень медленные запросы.
        Используется histogramm, чтобы визуально оценить распределение задержек.
        PromQL:
        sum(rate(prediction_latency_seconds_bucket[1m])) by (le)

    - Метрики инфраструктурного уровня (инфраструктурный слой):

        -- Уровень ошибок HTTP-запросов за 1 минуту / HTTP Requests Error Rate per 1 Minute

        Отражает процент неудачных запросов (ошибки клиента 4xx и сервера 5xx) от общего числа запросов за минуту.
        Эта метрика показывает надежность работы API и помогает оперативно реагировать на проблемы.
        Используется time-series для отслеживания изменений уровня ошибок.
        PromQL:
        sum(rate(http_requests_total{status=~"4..|5.."}[1m])) by (status)

        -- Средняя задержка HTTP-запросов / Average HTTP Request Latency

        Эта метрика отражает среднее за минуту время обработки HTTP-запросов (в секундах).
        Она показывает не только время выполнения предсказания, но и возможные сетевые задержки.
        Используется time-series, так как важно отслеживать динамику изменения задержек во времени и выявлять рост нагрузки.
        PromQL:
        sum(rate(http_request_duration_seconds_sum[1m])) / sum(rate(http_request_duration_seconds_count[1m]))